"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[206],{1227:function(e,t,r){r.d(t,{Z:function(){return n}});var a=r(3827),s=r(4090),l=r(5810);function n(e){let{isOpen:t,onClose:r,onSuccess:n}=e,[o,i]=(0,s.useState)(""),[d,c]=(0,s.useState)(!1),[x,h]=(0,s.useState)(""),u=async e=>{e.preventDefault(),c(!0),h("");try{await (0,l.Gw)(o)?n(o):h("API Key无效,请重试")}catch(e){h("验证失败,请重试")}finally{c(!1)}};return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"请输入API Key"}),(0,a.jsxs)("form",{onSubmit:u,children:[(0,a.jsx)("input",{type:"password",value:o,onChange:e=>i(e.target.value),className:"w-full p-2 border rounded mb-4 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"输入您的API Key",required:!0}),x&&(0,a.jsx)("p",{className:"text-red-500 mb-4",children:x}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white",children:"取消"}),(0,a.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",children:d?"验证中...":"验证"})]})]})]})}):null}},2218:function(e,t,r){r.d(t,{Z:function(){return h}});var a=r(3827),s=r(4090),l=r(703),n=r(8745),o=r(6680);let i=e=>{let t=e.startsWith("/")?e.substring(1):e;return"".concat(window.location.origin,"/").concat(t)},d=e=>e<1024?e+" B":e<1048576?(e/1024).toFixed(2)+" KB":e<1073741824?(e/1048576).toFixed(2)+" MB":(e/1073741824).toFixed(2)+" GB",c=e=>({png:"PNG",jpg:"JPG",jpeg:"JPEG",webp:"WebP",gif:"GIF"})[e.toLowerCase()]||e.toUpperCase(),x=e=>({landscape:"横向",portrait:"纵向",square:"方形"})[e.toLowerCase()]||e;function h(e){let{image:t,isOpen:r,onClose:h,onDelete:u}=e,[m,g]=(0,s.useState)(!1),[p,f]=(0,s.useState)(!1),[b,w]=(0,s.useState)("idle");(0,s.useEffect)(()=>{r||(g(!1),f(!1),w("idle"))},[r]);let y=async()=>{if(t)try{let e=i(t.url);await navigator.clipboard.writeText(e),w("copied"),setTimeout(()=>w("idle"),2e3)}catch(e){console.error("复制失败:",e),w("error"),setTimeout(()=>w("idle"),2e3)}},k=async()=>{if(t)try{f(!0),await u(t.id),h()}catch(e){console.error("删除失败:",e)}finally{f(!1)}};return t?(0,a.jsx)(n.M,{children:r&&(0,a.jsx)(o.E.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:h,children:(0,a.jsxs)(o.E.div,{className:"relative bg-white dark:bg-slate-900 rounded-xl overflow-hidden shadow-2xl max-w-4xl w-full flex flex-col",initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:300},onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{className:"absolute top-4 right-4 z-10 p-2 bg-black/20 dark:bg-white/10 rounded-full hover:bg-black/30 dark:hover:bg-white/20 transition-colors",onClick:h,children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsx)("div",{className:"border-b border-gray-100 dark:border-gray-800 px-6 py-4",children:(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white truncate",children:t.filename})}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,a.jsx)("div",{className:"relative w-full md:w-3/5 h-64 md:h-[400px] bg-gray-100 dark:bg-gray-800",children:(0,a.jsx)(l.default,{src:t.url,alt:t.filename,fill:!0,className:"object-contain",sizes:"(max-width: 768px) 100vw, 60vw"})}),(0,a.jsxs)("div",{className:"w-full md:w-2/5 p-6 flex flex-col h-full md:h-[400px] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mb-6",children:[(0,a.jsx)("div",{className:"flex items-center bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-300 px-3 py-1 rounded-full text-xs font-medium",children:c(t.format)}),(0,a.jsx)("div",{className:"flex items-center bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-300 px-3 py-1 rounded-full text-xs font-medium",children:x(t.orientation)}),(0,a.jsx)("div",{className:"flex items-center bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-300 px-3 py-1 rounded-full text-xs font-medium",children:d(t.size)}),t.width&&t.height&&(0,a.jsxs)("div",{className:"flex items-center bg-amber-50 dark:bg-amber-900/20 text-amber-600 dark:text-amber-300 px-3 py-1 rounded-full text-xs font-medium",children:[t.width," x ",t.height]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"路径"}),(0,a.jsx)("div",{className:"font-mono text-xs bg-gray-50 dark:bg-gray-800 p-2 rounded text-gray-700 dark:text-gray-300 truncate",children:t.path})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"URL"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"font-mono text-xs bg-gray-50 dark:bg-gray-800 p-2 pr-10 rounded text-gray-700 dark:text-gray-300 truncate",children:i(t.url)}),(0,a.jsxs)("button",{onClick:y,className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-1.5 rounded hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"复制URL",children:["idle"===b&&(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500 dark:text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"copied"===b&&(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"error"===b&&(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),(0,a.jsx)("div",{className:"text-xs mt-1 text-gray-500 dark:text-gray-400",children:"copied"===b?"URL已复制到剪贴板":"点击右侧按钮复制URL"})]})]}),(0,a.jsx)("div",{className:"mt-auto pt-4",children:m?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-center text-sm text-red-600 dark:text-red-400",children:"确定要删除此图片吗？"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>g(!1),className:"flex-1 py-2 px-4 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors text-sm",disabled:p,children:"取消"}),(0,a.jsx)("button",{onClick:k,className:"flex-1 py-2 px-4 rounded-lg bg-red-500 hover:bg-red-600 text-white transition-colors text-sm flex items-center justify-center",disabled:p,children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"处理中"]}):"确认删除"})]})]}):(0,a.jsxs)("button",{onClick:()=>g(!0),className:"flex items-center justify-center w-full p-2.5 rounded-lg border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"删除图片"]})})]})]})]})})}):null}},7007:function(e,t,r){r.d(t,{F:function(){return s}});var a=r(4090);function s(){let[e,t]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=localStorage.getItem("theme");e&&(t("dark"===e),document.documentElement.classList.toggle("dark","dark"===e))},[]),{isDarkMode:e,toggleTheme:()=>{let r=!e;t(r),localStorage.setItem("theme",r?"dark":"light"),document.documentElement.classList.toggle("dark",r)}}}},5810:function(e,t,r){r.d(t,{Gw:function(){return n},Lb:function(){return l},Pi:function(){return s}});let a="imageflow_api_key",s=()=>localStorage.getItem(a),l=e=>{localStorage.setItem(a,e)},n=async e=>{try{let t=await fetch("".concat("","/validate-api-key"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}),r=await t.json();return!0===r.valid}catch(e){return console.error("API Key validation error:",e),!1}}},3914:function(e,t,r){r.d(t,{hi:function(){return l}});var a=r(5810);async function s(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,a.Pi)();if(!s)throw Error("未设置API Key");let{params:l,...n}=r;try{t=new URL(e,window.location.origin)}catch(r){t=new URL(e,window.location.origin)}l&&Object.entries(l).forEach(e=>{let[r,a]=e;t.searchParams.append(r,a)});let o={Authorization:"Bearer ".concat(s),...r.headers},i=await fetch(t.toString(),{...n,headers:o});if(!i.ok)throw Error((await i.json().catch(()=>({}))).message||"请求失败");return i.json()}let l={get:(e,t)=>s(e,{method:"GET",params:t}),post:(e,t)=>s(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),delete:e=>s(e,{method:"DELETE"}),upload:(e,t)=>{let r=new FormData;return t.forEach(e=>{r.append("images[]",e)}),s(e,{method:"POST",body:r})}}}}]);