(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[133],{4223:function(e,t,a){Promise.resolve().then(a.bind(a,2513))},1227:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var r=a(3827),s=a(4090),i=a(5810);function n(e){let{isOpen:t,onClose:a,onSuccess:n}=e,[l,o]=(0,s.useState)(""),[d,c]=(0,s.useState)(!1),[x,m]=(0,s.useState)(""),g=async e=>{e.preventDefault(),c(!0),m("");try{await (0,i.Gw)(l)?n(l):m("API Key无效,请重试")}catch(e){m("验证失败,请重试")}finally{c(!1)}};return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"请输入API Key"}),(0,r.jsxs)("form",{onSubmit:g,children:[(0,r.jsx)("input",{type:"password",value:l,onChange:e=>o(e.target.value),className:"w-full p-2 border rounded mb-4 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"输入您的API Key",required:!0}),x&&(0,r.jsx)("p",{className:"text-red-500 mb-4",children:x}),(0,r.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,r.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white",children:"取消"}),(0,r.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",children:d?"验证中...":"验证"})]})]})]})}):null}},7007:function(e,t,a){"use strict";a.d(t,{F:function(){return s}});var r=a(4090);function s(){let[e,t]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=localStorage.getItem("theme");e&&(t("dark"===e),document.documentElement.classList.toggle("dark","dark"===e))},[]),{isDarkMode:e,toggleTheme:()=>{let a=!e;t(a),localStorage.setItem("theme",a?"dark":"light"),document.documentElement.classList.toggle("dark",a)}}}},2513:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});var r=a(3827),s=a(4090),i=a(8792),n=a(5810),l=a(3914),o=a(1227);function d(e){let{onFilterChange:t}=e,[a,i]=(0,s.useState)("all"),[n,l]=(0,s.useState)("all"),o=e=>{i(e),t(e,n),console.log(e,n)},d=e=>{l(e),t(a,e),console.log(a,e)};return(0,r.jsxs)("div",{className:"flex gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"格式"}),(0,r.jsxs)("select",{value:a,className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",onChange:e=>o(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"所有格式"}),(0,r.jsx)("option",{value:"original",children:"原始格式"}),(0,r.jsx)("option",{value:"webp",children:"WebP"}),(0,r.jsx)("option",{value:"avif",children:"AVIF"}),(0,r.jsx)("option",{value:"gif",children:"GIF"})]})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"方向"}),(0,r.jsxs)("select",{value:n,disabled:"gif"===a,className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 ".concat("gif"===a?"opacity-50 cursor-not-allowed":""),onChange:e=>d(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"所有方向"}),(0,r.jsx)("option",{value:"landscape",children:"横向"}),(0,r.jsx)("option",{value:"portrait",children:"纵向"})]})]})]})}var c=a(703),x=a(6680);async function m(e){try{return await navigator.clipboard.writeText(e),!0}catch(e){return console.error("复制到剪贴板失败:",e),!1}}let g=e=>{switch(e){case"original":return"原始";case"webp":return"WebP";case"avif":return"AVIF";case"gif":return"GIF";default:return e}},u=e=>{switch(e){case"landscape":return"横向";case"portrait":return"纵向";case"gif":return"GIF";default:return e}},h=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]};function y(e){let{image:t,onClick:a}=e,[i,n]=(0,s.useState)(!1),[l,o]=(0,s.useState)(!1),d="portrait"===t.orientation?"aspect-[3/4]":"aspect-video",y=async e=>{e.stopPropagation(),await m(t.url)&&(n(!0),setTimeout(()=>n(!1),2e3))};return(0,r.jsxs)(x.E.div,{className:"bg-gray-50 dark:bg-gray-700 rounded-xl overflow-hidden shadow-md hover:shadow-lg transition-all transform cursor-pointer",onClick:a,onHoverStart:()=>o(!0),onHoverEnd:()=>o(!1),whileHover:{y:-4},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[(0,r.jsxs)("div",{className:"relative ".concat(d," bg-gray-200 dark:bg-gray-600 overflow-hidden flex items-center justify-center"),children:[(0,r.jsx)(x.E.div,{className:"w-full h-full",animate:{scale:l?1.05:1},transition:{duration:.3},children:(0,r.jsx)(c.default,{src:t.url,alt:t.filename,fill:!0,className:"object-cover"})}),(0,r.jsxs)(x.E.div,{className:"absolute top-2 right-2 flex gap-1",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.2},children:[(0,r.jsx)("span",{className:"px-2 py-1 bg-indigo-500 bg-opacity-80 text-white text-xs rounded-md",children:g(t.format)}),(0,r.jsx)("span",{className:"px-2 py-1 bg-purple-500 bg-opacity-80 text-white text-xs rounded-md",children:u(t.orientation)})]}),(0,r.jsx)(x.E.button,{onClick:y,className:"absolute bottom-2 right-2 p-2 bg-white dark:bg-gray-800 rounded-lg shadow-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",whileHover:{scale:1.1},whileTap:{scale:.95},children:i?(0,r.jsx)(x.E.svg,{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-500",initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30},children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-600 dark:text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,r.jsx)("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),(0,r.jsx)("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"})]})})]}),(0,r.jsxs)(x.E.div,{className:"p-3",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[(0,r.jsx)("div",{className:"truncate text-gray-800 dark:text-gray-200 font-medium",children:t.filename}),(0,r.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm",children:h(t.size)})]})]})}var p=a(8745);let f=e=>{switch(e){case"original":return"原始";case"webp":return"WebP";case"avif":return"AVIF";case"gif":return"GIF";default:return e}},b=e=>{switch(e){case"landscape":return"横向";case"portrait":return"纵向";case"gif":return"GIF";default:return e}},j=e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["B","KB","MB","GB"][t]};function v(e){var t;let{image:a,isOpen:i,onClose:n,onDelete:l}=e,[o,d]=(0,s.useState)(!1),[g,u]=(0,s.useState)(!1),[h,y]=(0,s.useState)("idle"),v=a?(t=a.url).startsWith("http")?t:"".concat(window.location.protocol,"//").concat(window.location.host).concat(t):"",w=async e=>{y("idle");try{await m(e),y("success"),setTimeout(()=>y("idle"),2e3)}catch(e){y("error"),setTimeout(()=>y("idle"),2e3)}},k=async()=>{if(a){d(!0);try{await l(a.id),n()}catch(e){console.error("删除失败:",e)}finally{d(!1),u(!1)}}};return a?(0,r.jsx)(p.M,{children:i&&(0,r.jsxs)(x.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex min-h-screen items-center justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)(x.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:n}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:h-screen sm:align-middle",children:"​"}),(0,r.jsxs)(x.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"inline-block transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 px-4 pt-5 pb-4 text-left align-middle shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-4xl sm:p-6 relative",children:[(0,r.jsx)("div",{className:"absolute top-0 right-0 pt-4 pr-4",children:(0,r.jsxs)("button",{type:"button",className:"rounded-md bg-white dark:bg-gray-800 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:n,children:[(0,r.jsx)("span",{className:"sr-only",children:"关闭"}),(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,r.jsx)(x.E.div,{className:"md:w-2/3 relative aspect-video",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:(0,r.jsx)(c.default,{src:a.url,alt:a.filename,fill:!0,className:"object-contain"})}),(0,r.jsxs)(x.E.div,{className:"md:w-1/3 space-y-4",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"文件名"}),(0,r.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:a.filename})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"路径"}),(0,r.jsx)("p",{className:"text-gray-900 dark:text-gray-100 break-all",children:a.path})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"大小"}),(0,r.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:j(a.size)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"格式"}),(0,r.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:f(a.format)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"方向"}),(0,r.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:b(a.orientation)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"URL"}),(0,r.jsxs)("div",{className:"mt-1 flex",children:[(0,r.jsx)("input",{type:"text",readOnly:!0,value:v,className:"flex-1 rounded-l-lg border border-r-0 border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm"}),(0,r.jsxs)("button",{onClick:()=>w(v),className:"px-3 rounded-r-lg border border-l-0 border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600",children:["idle"===h&&(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})}),"success"===h&&(0,r.jsx)("svg",{className:"w-5 h-5 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"error"===h&&(0,r.jsx)("svg",{className:"w-5 h-5 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"button",onClick:()=>u(!0),disabled:o,className:"w-full inline-flex justify-center rounded-md border border-transparent bg-red-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?"删除中...":"删除图片"})})]})]})]})]}),(0,r.jsx)(p.M,{children:g&&(0,r.jsx)(x.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[60] overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex min-h-screen items-center justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)(x.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>u(!1)}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:h-screen sm:align-middle",children:"​"}),(0,r.jsxs)(x.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"inline-block transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 px-4 pt-5 pb-4 text-left align-middle shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6 relative",children:[(0,r.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,r.jsx)("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/20 sm:mx-0 sm:h-10 sm:w-10",children:(0,r.jsx)("svg",{className:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,r.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900 dark:text-gray-100",children:"确认删除"}),(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"您确定要删除这张图片吗？此操作无法撤销。"})})]})]}),(0,r.jsxs)("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:[(0,r.jsx)("button",{type:"button",onClick:k,disabled:o,className:"inline-flex w-full justify-center rounded-md border border-transparent bg-red-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:o?"删除中...":"确认删除"}),(0,r.jsx)("button",{type:"button",onClick:()=>u(!1),className:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-4 py-2 text-base font-medium text-gray-700 dark:text-gray-200 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:mt-0 sm:w-auto sm:text-sm",children:"取消"})]})]})]})})})]})}):null}function w(e){let{currentPage:t,totalPages:a,onPageChange:s}=e;return a<=1?null:(0,r.jsxs)("div",{className:"flex items-center justify-between mt-6",children:[(0,r.jsxs)("button",{onClick:()=>s(t-1),disabled:t<=1,className:"flex items-center px-4 py-2 text-sm font-medium rounded-md ".concat(t<=1?"text-gray-400 dark:text-gray-500 cursor-not-allowed":"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"),children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"上一页"]}),(0,r.jsxs)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:["第 ",t," 页，共 ",a," 页"]}),(0,r.jsxs)("button",{onClick:()=>s(t+1),disabled:t>=a,className:"flex items-center px-4 py-2 text-sm font-medium rounded-md ".concat(t>=a?"text-gray-400 dark:text-gray-500 cursor-not-allowed":"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"),children:["下一页",(0,r.jsx)("svg",{className:"w-5 h-5 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})}var k=a(7007);function N(){let{isDarkMode:e,toggleTheme:t}=(0,k.F)(),[a,c]=(0,s.useState)(!1),[x,m]=(0,s.useState)([]),[g,u]=(0,s.useState)(null),[h,p]=(0,s.useState)(!0),[f,b]=(0,s.useState)(null),[j,N]=(0,s.useState)(1),[L,C]=(0,s.useState)(1),[M,S]=(0,s.useState)(0),[E,B]=(0,s.useState)({format:"all",orientation:"all"});(0,s.useEffect)(()=>{(async()=>{let e=(0,n.Pi)();if(!e){c(!0);return}if(!await (0,n.Gw)(e)){c(!0),b({type:"error",message:"API Key无效,请重新验证"});return}P()})()},[]);let P=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;try{p(!0);let t=await l.hi.get("/api/images",{page:e.toString(),limit:"12",format:E.format,orientation:E.orientation});console.log(t),m(t.images),N(t.page),C(t.totalPages),S(t.total),b(null)}catch(e){console.error("加载图片列表失败:",e),b({type:"error",message:"加载图片列表失败"})}finally{p(!1)}},F=async e=>{try{let t=x.find(t=>t.id===e);if(!t)return;let a=await l.hi.post("/api/delete-image",{id:t.id,storageType:t.storageType});a.success?(m(x.filter(t=>t.id!==e)),b({type:"success",message:a.message})):b({type:"error",message:a.message})}catch(e){console.error("删除失败:",e),b({type:"error",message:"删除失败"})}};return(0,s.useEffect)(()=>{console.log("Filters changed:",E),N(1),P(1)},[E]),(0,s.useEffect)(()=>{P(j)},[j]),(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-6 py-8",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-10",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(i.default,{href:"/",className:"mr-4",children:(0,r.jsx)("div",{className:"bg-gradient-primary w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg transform rotate-12",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,r.jsx)("h1",{className:"text-4xl font-bold bg-clip-text text-transparent bg-gradient-primary",children:"图片管理"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>c(!0),className:"btn-icon",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),(0,r.jsx)("button",{onClick:t,className:"btn-icon",children:e?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-700 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})})]})]}),f&&(0,r.jsx)("div",{className:"mb-8 p-4 rounded-xl ".concat("success"===f.type?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300"),children:f.message}),(0,r.jsx)(d,{onFilterChange:(e,t)=>{B({format:e,orientation:t}),console.log(e,t)}}),h?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"})}):(0,r.jsx)(r.Fragment,{children:x.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(e=>(0,r.jsx)(y,{image:e,onClick:()=>u(e)},e.id))}),(0,r.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["共 ",M," 张图片"]}),(0,r.jsx)(w,{currentPage:j,totalPages:L,onPageChange:e=>{N(e)}})]})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500 dark:text-gray-400",children:[(0,r.jsx)("svg",{className:"w-16 h-16 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsx)("p",{children:"暂无图片"})]})}),(0,r.jsx)(v,{image:g,isOpen:!!g,onClose:()=>u(null),onDelete:F}),(0,r.jsx)(o.Z,{isOpen:a,onClose:()=>c(!1),onSuccess:e=>{(0,n.Lb)(e),c(!1),b({type:"success",message:"API Key验证成功！"}),P()}})]})}},5810:function(e,t,a){"use strict";a.d(t,{Gw:function(){return n},Lb:function(){return i},Pi:function(){return s}});let r="imageflow_api_key",s=()=>localStorage.getItem(r),i=e=>{localStorage.setItem(r,e)},n=async e=>{try{let t=await fetch("".concat("http://localhost:8686","/validate-api-key"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}),a=await t.json();return!0===a.valid}catch(e){return console.error("API Key validation error:",e),!1}}},3914:function(e,t,a){"use strict";a.d(t,{hi:function(){return i}});var r=a(5810);async function s(e){let t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,r.Pi)();if(!s)throw Error("未设置API Key");let{params:i,...n}=a;try{t=new URL(e,window.location.origin)}catch(a){t=new URL(e,"http://localhost:8686")}i&&Object.entries(i).forEach(e=>{let[a,r]=e;t.searchParams.append(a,r)});let l={Authorization:"Bearer ".concat(s),...a.headers},o=await fetch(t.toString(),{...n,headers:l});if(!o.ok)throw Error((await o.json().catch(()=>({}))).message||"请求失败");return o.json()}let i={get:(e,t)=>s(e,{method:"GET",params:t}),post:(e,t)=>s(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),delete:e=>s(e,{method:"DELETE"}),upload:(e,t)=>{let a=new FormData;return t.forEach(e=>{a.append("images[]",e)}),s(e,{method:"POST",body:a})}}}},function(e){e.O(0,[142,971,69,744],function(){return e(e.s=4223)}),_N_E=e.O()}]);