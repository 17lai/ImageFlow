(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5294:function(e,t,r){Promise.resolve().then(r.bind(r,3200))},1227:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var s=r(3827),a=r(4090),n=r(5810);function l(e){let{isOpen:t,onClose:r,onSuccess:l}=e,[i,o]=(0,a.useState)(""),[d,c]=(0,a.useState)(!1),[h,x]=(0,a.useState)(""),u=async e=>{e.preventDefault(),c(!0),x("");try{await (0,n.Gw)(i)?l(i):x("API Key无效,请重试")}catch(e){x("验证失败,请重试")}finally{c(!1)}};return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-white",children:"请输入API Key"}),(0,s.jsxs)("form",{onSubmit:u,children:[(0,s.jsx)("input",{type:"password",value:i,onChange:e=>o(e.target.value),className:"w-full p-2 border rounded mb-4 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"输入您的API Key",required:!0}),h&&(0,s.jsx)("p",{className:"text-red-500 mb-4",children:h}),(0,s.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,s.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-white",children:"取消"}),(0,s.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50",children:d?"验证中...":"验证"})]})]})]})}):null}},7007:function(e,t,r){"use strict";r.d(t,{F:function(){return a}});var s=r(4090);function a(){let[e,t]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=localStorage.getItem("theme");e&&(t("dark"===e),document.documentElement.classList.toggle("dark","dark"===e))},[]),{isDarkMode:e,toggleTheme:()=>{let r=!e;t(r),localStorage.setItem("theme",r?"dark":"light"),document.documentElement.classList.toggle("dark",r)}}}},3200:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var s=r(3827),a=r(4090),n=r(5810),l=r(3914),i=r(1227),o=r(8792),d=r(7007);function c(e){let{onApiKeyClick:t}=e,{isDarkMode:r,toggleTheme:a}=(0,d.F)();return(0,s.jsxs)("div",{className:"flex items-center justify-between mb-10",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(o.default,{href:"/",className:"mr-4",children:(0,s.jsx)("div",{className:"bg-gradient-primary w-14 h-14 rounded-2xl flex items-center justify-center shadow-lg transform rotate-12",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,s.jsx)("h1",{className:"text-4xl font-bold bg-clip-text text-transparent bg-gradient-primary",children:"ImageFlow"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(o.default,{href:"/manage",className:"btn-icon",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})}),(0,s.jsx)("button",{onClick:t,className:"btn-icon",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),(0,s.jsx)("button",{onClick:a,className:"btn-icon",children:r?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-700 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})})]})]})}var h=r(703);function x(e){let{onUpload:t,isUploading:r}=e,[n,l]=(0,a.useState)([]),[i,o]=(0,a.useState)([]),d=e=>{let t=i.filter(t=>t.id!==e);o(t),l(n.filter(e=>t.some(t=>t.file===e)))},c=async e=>{e.preventDefault(),0!==n.length&&await t(n)};return(0,s.jsxs)("div",{className:"card p-8 mb-8",children:[(0,s.jsxs)("h2",{className:"text-2xl font-semibold mb-6 flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"上传图片"]}),(0,s.jsxs)("form",{onSubmit:c,children:[(0,s.jsxs)("div",{className:"drop-zone mb-6 flex flex-col items-center justify-center cursor-pointer",onDrop:e=>{e.preventDefault();let t=Array.from(e.dataTransfer.files);l(t);let r=t.map(e=>({id:Math.random().toString(36).substring(2,11),url:"",file:e}));r.forEach((e,r)=>{let s=new FileReader;s.onload=t=>{o(r=>{let s=[...r],a=s.findIndex(t=>t.id===e.id);if(-1!==a){var n;s[a]={...s[a],url:null===(n=t.target)||void 0===n?void 0:n.result}}return s})},s.readAsDataURL(t[r])}),o(r)},onDragOver:e=>{e.preventDefault(),e.currentTarget.classList.add("active")},onDragLeave:e=>{e.preventDefault(),e.currentTarget.classList.remove("active")},children:[(0,s.jsx)("div",{className:"mb-4 bg-indigo-100 dark:bg-indigo-900/50 p-4 rounded-full",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,s.jsx)("p",{className:"text-lg font-medium mb-2",children:"拖放多张图片到这里"}),(0,s.jsx)("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary mb-4",children:"或者点击选择文件（可多选）"}),(0,s.jsx)("input",{type:"file",id:"file-input",className:"hidden",accept:"image/*",multiple:!0,onChange:e=>{let t=Array.from(e.target.files||[]);l(t);let r=t.map(e=>({id:Math.random().toString(36).substring(2,11),url:"",file:e}));r.forEach((e,r)=>{let s=new FileReader;s.onload=t=>{o(r=>{let s=[...r],a=s.findIndex(t=>t.id===e.id);if(-1!==a){var n;s[a]={...s[a],url:null===(n=t.target)||void 0===n?void 0:n.result}}return s})},s.readAsDataURL(t[r])}),o(r)}}),(0,s.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=document.getElementById("file-input"))||void 0===e?void 0:e.click()},className:"btn-primary px-4 py-2",children:"选择图片"})]}),i.length>0&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsxs)("h3",{className:"font-medium",children:["已选择 ",i.length," 张图片"]}),(0,s.jsx)("button",{type:"button",onClick:()=>{l([]),o([])},className:"text-sm text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",children:"清除全部"})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:i.map(e=>(0,s.jsxs)("div",{className:"relative group rounded-lg overflow-hidden bg-light-bg-secondary dark:bg-dark-bg-secondary border border-light-border dark:border-dark-border",children:[e.url?(0,s.jsxs)("div",{className:"aspect-square relative",children:[(0,s.jsx)(h.default,{src:e.url,alt:e.file.name,fill:!0,className:"object-cover"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-all duration-200"}),(0,s.jsx)("button",{type:"button",onClick:()=>d(e.id),className:"absolute top-1 right-1 bg-white/80 dark:bg-gray-800/80 rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-700 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}):(0,s.jsx)("div",{className:"aspect-square flex items-center justify-center bg-gray-100 dark:bg-gray-800",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 5a2 2 0 10-4 0 2 2 0 004 0z"})]})}),(0,s.jsx)("div",{className:"p-2 text-xs truncate",children:e.file.name})]},e.id))})]}),n.length>0&&(0,s.jsx)("button",{type:"submit",disabled:r,className:"w-full py-3 btn-primary disabled:opacity-50",children:r?"上传中...":"上传图片"})]})]})}var u=r(748);function m(e){let{type:t,message:r}=e;return(0,s.jsx)(u.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-8 p-4 rounded-xl ".concat("success"===t?"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300":"warning"===t?"bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-300":"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300"),children:r})}function g(e){let{progress:t}=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"bg-light-bg-primary dark:bg-dark-bg-primary rounded-xl overflow-hidden mb-4",children:(0,s.jsx)("div",{className:"h-2 bg-gradient-primary transition-all duration-300",style:{width:"".concat(t,"%")}})}),(0,s.jsxs)("p",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary text-center",children:["上传进度: ",Math.round(t),"%"]})]})}function p(e){var t,r,n;let{result:l,index:i}=e,[o,d]=(0,a.useState)(null),c=(e,t)=>{navigator.clipboard.writeText(e).then(()=>{d({type:t}),setTimeout(()=>{d(null)},2e3)})},x=e=>e?function(e){if(!e)return"";if(e.startsWith("http://")||e.startsWith("https://"))return e;try{return new URL(e,"http://localhost:8686").toString()}catch(t){return console.error("URL格式错误:",t),e}}(e):"",m=x(null===(t=l.urls)||void 0===t?void 0:t.original),g=x(null===(r=l.urls)||void 0===r?void 0:r.webp),p=x(null===(n=l.urls)||void 0===n?void 0:n.avif);return(0,s.jsxs)(u.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*i},className:"card p-0 rounded-xl overflow-hidden mb-6 bg-light-bg-secondary dark:bg-slate-800/80 border border-light-border dark:border-slate-700 shadow-sm hover:shadow-md transition-all duration-300",children:["success"===l.status&&l.urls&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"p-4 flex items-center justify-between border-b border-light-border dark:border-slate-700 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-white dark:bg-slate-800 flex items-center justify-center shadow-sm",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-xl",children:l.filename}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["上传成功 \xb7 ",new Date().toLocaleDateString()]})]})]}),(0,s.jsx)("span",{className:"text-sm px-3 py-1 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 rounded-full shadow-sm",children:l.message})]}),(0,s.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,s.jsx)("div",{className:"w-full md:w-80 p-4 md:border-r border-light-border dark:border-slate-700 bg-light-bg-secondary/50 dark:bg-slate-800/50",children:(0,s.jsx)("div",{className:"overflow-hidden rounded-lg border-2 border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md transition-all duration-300 transform hover:scale-[1.02] cursor-pointer",children:(0,s.jsx)("div",{className:"aspect-square relative",children:(0,s.jsx)(h.default,{src:m,alt:l.filename,fill:!0,sizes:"(max-width: 768px) 100vw, 300px",className:"object-cover"})})})}),(0,s.jsx)("div",{className:"flex-1 p-4",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 group",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-md flex items-center justify-center bg-blue-100 dark:bg-blue-900/30",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14"})})}),(0,s.jsx)("div",{className:"font-medium text-lg",children:"原始图片"})]}),(0,s.jsxs)("div",{className:"rounded-lg bg-slate-100 dark:bg-slate-900 flex items-center group relative hover:bg-slate-200 dark:hover:bg-slate-800/80 transition-colors duration-200",children:[(0,s.jsx)("div",{className:"flex-1 px-4 py-3 text-sm font-mono overflow-hidden text-ellipsis",children:m||""}),(0,s.jsx)("div",{className:"absolute left-0 -top-10 bg-black/80 text-white text-xs rounded-md p-2 invisible group-hover:visible transition-all duration-200 w-auto max-w-[90%] truncate shadow-lg",children:m||""}),(0,s.jsxs)("button",{onClick:()=>c(m||"","original"),className:"p-3 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-r-lg transition-colors duration-200 relative",title:"复制链接",children:[o&&"original"===o.type?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),o&&"original"===o.type&&(0,s.jsx)("span",{className:"absolute -top-8 right-0 bg-black/70 text-white text-xs rounded px-2 py-1",children:"已复制!"})]})]}),g&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 group mt-6",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-md flex items-center justify-center bg-purple-100 dark:bg-purple-900/30",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-purple-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,s.jsx)("div",{className:"font-medium text-lg",children:"WebP 格式"})]}),(0,s.jsxs)("div",{className:"rounded-lg bg-slate-100 dark:bg-slate-900 flex items-center group relative hover:bg-slate-200 dark:hover:bg-slate-800/80 transition-colors duration-200",children:[(0,s.jsx)("div",{className:"flex-1 px-4 py-3 text-sm font-mono overflow-hidden text-ellipsis",children:g||""}),(0,s.jsx)("div",{className:"absolute left-0 -top-10 bg-black/80 text-white text-xs rounded-md p-2 invisible group-hover:visible transition-all duration-200 w-auto max-w-[90%] truncate shadow-lg",children:g||""}),(0,s.jsxs)("button",{onClick:()=>c(g||"","webp"),className:"p-3 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-r-lg transition-colors duration-200 relative",title:"复制链接",children:[o&&"webp"===o.type?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),o&&"webp"===o.type&&(0,s.jsx)("span",{className:"absolute -top-8 right-0 bg-black/70 text-white text-xs rounded px-2 py-1",children:"已复制!"})]})]})]}),p&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 group mt-6",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-md flex items-center justify-center bg-green-100 dark:bg-green-900/30",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,s.jsx)("div",{className:"font-medium text-lg",children:"AVIF 格式"})]}),(0,s.jsxs)("div",{className:"rounded-lg bg-slate-100 dark:bg-slate-900 flex items-center group relative hover:bg-slate-200 dark:hover:bg-slate-800/80 transition-colors duration-200",children:[(0,s.jsx)("div",{className:"flex-1 px-4 py-3 text-sm font-mono overflow-hidden text-ellipsis",children:p||""}),(0,s.jsx)("div",{className:"absolute left-0 -top-10 bg-black/80 text-white text-xs rounded-md p-2 invisible group-hover:visible transition-all duration-200 w-auto max-w-[90%] truncate shadow-lg",children:p||""}),(0,s.jsxs)("button",{onClick:()=>c(p||"","avif"),className:"p-3 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-r-lg transition-colors duration-200 relative",title:"复制链接",children:[o&&"avif"===o.type?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),o&&"avif"===o.type&&(0,s.jsx)("span",{className:"absolute -top-8 right-0 bg-black/70 text-white text-xs rounded px-2 py-1",children:"已复制!"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 group mt-6",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-md flex items-center justify-center bg-amber-100 dark:bg-amber-900/30",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})})}),(0,s.jsx)("div",{className:"font-medium text-lg",children:"Markdown 格式"})]}),(0,s.jsxs)("div",{className:"rounded-lg bg-slate-100 dark:bg-slate-900 flex items-center group relative hover:bg-slate-200 dark:hover:bg-slate-800/80 transition-colors duration-200",children:[(0,s.jsxs)("div",{className:"flex-1 px-4 py-3 text-sm font-mono overflow-hidden text-ellipsis",children:["![",l.filename,"](",m||"",")"]}),(0,s.jsxs)("div",{className:"absolute left-0 -top-10 bg-black/80 text-white text-xs rounded-md p-2 invisible group-hover:visible transition-all duration-200 w-auto max-w-[90%] truncate shadow-lg",children:["![",l.filename,"](",m||"",")"]}),(0,s.jsxs)("button",{onClick:()=>c("![".concat(l.filename,"](").concat(m||"",")"),"markdown"),className:"p-3 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-r-lg transition-colors duration-200 relative",title:"复制链接",children:[o&&"markdown"===o.type?(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),o&&"markdown"===o.type&&(0,s.jsx)("span",{className:"absolute -top-8 right-0 bg-black/70 text-white text-xs rounded px-2 py-1",children:"已复制!"})]})]})]})})]})]}),"error"===l.status&&(0,s.jsx)("div",{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-lg",children:l.filename}),(0,s.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400",children:l.message})]})]})})]})}function v(e){let{results:t}=e;return t.length?(0,s.jsx)(u.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:t.map((e,t)=>(0,s.jsx)(p,{result:e,index:t},t))}):null}function w(){return(0,s.jsxs)("div",{className:"card p-5 mb-8",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"使用提示"]}),(0,s.jsxs)("ul",{className:"text-sm text-light-text-secondary dark:text-dark-text-secondary space-y-2 list-disc list-inside",children:[(0,s.jsx)("li",{children:"支持一次上传多张图片，可以拖放或点击选择"}),(0,s.jsx)("li",{children:"上传前可预览所有选中的图片，并可单独删除不需要的图片"}),(0,s.jsx)("li",{children:"每张图片将自动转换为多种格式，以提升加载速度"}),(0,s.jsx)("li",{children:"上传完成后，您可以查看每张图片的详细信息和访问链接"})]})]})}function b(){return(0,s.jsx)("footer",{className:"mt-auto pt-6 pb-4 text-center text-sm text-light-text-secondary dark:text-dark-text-secondary",children:(0,s.jsx)("p",{children:"ImageFlow - 简单高效的图片处理工具"})})}function j(){let[e,t]=(0,a.useState)(!1),[r,o]=(0,a.useState)(!1),[d,h]=(0,a.useState)(0),[u,p]=(0,a.useState)(null),[j,f]=(0,a.useState)([]);(0,a.useEffect)(()=>{(async()=>{let e=(0,n.Pi)();if(!e){t(!0);return}await (0,n.Gw)(e)||(t(!0),p({type:"error",message:"API Key无效,请重新验证"}))})()},[]);let k=async e=>{if(!(0,n.Pi)()){t(!0);return}o(!0),h(0),f([]);try{let t=setInterval(()=>{h(e=>e>=90?(clearInterval(t),e):e+5)},300),r=await l.hi.upload("/upload",e);clearInterval(t),h(100),f(r.results);let s=r.results.filter(e=>"success"===e.status).length,a=r.results.filter(e=>"error"===e.status).length,n=r.results.length;p({type:0===a?"success":"warning",message:"上传完成：共".concat(n,"张，").concat(s,"张成功，").concat(a,"张失败")})}catch(e){p({type:"error",message:"上传失败，请重试"})}finally{o(!1),setTimeout(()=>h(0),1e3)}};return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-6 py-8",children:[(0,s.jsx)(c,{onApiKeyClick:()=>t(!0)}),(0,s.jsx)(x,{onUpload:k,isUploading:r}),u&&(0,s.jsx)(m,{type:u.type,message:u.message}),(0,s.jsx)(v,{results:j}),r&&(0,s.jsx)(g,{progress:d}),(0,s.jsx)(w,{}),(0,s.jsx)(b,{}),(0,s.jsx)(i.Z,{isOpen:e,onClose:()=>t(!1),onSuccess:e=>{(0,n.Lb)(e),t(!1),p({type:"success",message:"API Key验证成功！"})}})]})}},5810:function(e,t,r){"use strict";r.d(t,{Gw:function(){return l},Lb:function(){return n},Pi:function(){return a}});let s="imageflow_api_key",a=()=>localStorage.getItem(s),n=e=>{localStorage.setItem(s,e)},l=async e=>{try{let t=await fetch("".concat("http://localhost:8686","/validate-api-key"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}),r=await t.json();return!0===r.valid}catch(e){return console.error("API Key validation error:",e),!1}}},3914:function(e,t,r){"use strict";r.d(t,{hi:function(){return n}});var s=r(5810);async function a(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(0,s.Pi)();if(!a)throw Error("未设置API Key");let{params:n,...l}=r;try{t=new URL(e,window.location.origin)}catch(r){t=new URL(e,"http://localhost:8686")}n&&Object.entries(n).forEach(e=>{let[r,s]=e;t.searchParams.append(r,s)});let i={Authorization:"Bearer ".concat(a),...r.headers},o=await fetch(t.toString(),{...l,headers:i});if(!o.ok)throw Error((await o.json().catch(()=>({}))).message||"请求失败");return o.json()}let n={get:(e,t)=>a(e,{method:"GET",params:t}),post:(e,t)=>a(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),delete:e=>a(e,{method:"DELETE"}),upload:(e,t)=>{let r=new FormData;return t.forEach(e=>{r.append("images[]",e)}),a(e,{method:"POST",body:r})}}}},function(e){e.O(0,[597,971,69,744],function(){return e(e.s=5294)}),_N_E=e.O()}]);